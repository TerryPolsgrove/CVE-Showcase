from flask import Flask, render_template
import requests

# Create a Flask application
app = Flask(__name__)

# Function to fetch 30 newest CVEs
def get_newest_cves():
    # Define the URL to fetch CVEs
    url = "https://cve.circl.lu/api/last?size=10"
    
    # Send a GET request to the URL
    response = requests.get(url)
    
    # Check if the response status code is 200 (OK)
    if response.status_code == 200:
        # Parse the JSON response
        cves = response.json()
        return cves
    else:
        # Return an empty list in case of an error
        return []

# Define a route for the root URL
@app.route('/')
def index():
    # Call the get_newest_cves function to fetch the CVEs
    cves = get_newest_cves()
    
    # Render the 'index.html' template with the CVEs data
    return render_template('index.html', cves=cves)

# Run the Flask application in debug mode if this script is executed
if __name__ == '__main__':
    app.run(debug=True)
